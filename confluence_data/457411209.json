{
    "parentId": "457083187",
    "ownerId": "60653f79352e1e0069fb728f",
    "lastOwnerId": null,
    "createdAt": "2024-12-21T16:42:52.599Z",
    "authorId": "60653f79352e1e0069fb728f",
    "parentType": "page",
    "position": 27388094,
    "version": {
        "number": 1,
        "message": "",
        "minorEdit": false,
        "authorId": "60653f79352e1e0069fb728f",
        "createdAt": "2024-12-21T16:42:54.431Z"
    },
    "body": {
        "export_view": {
            "representation": "export_view",
            "value": "<p>This section describes the core processing functions of the SPAN Risk Manager.\u00a0 All such functions can be executed from the GUI, from the script language (via &quot;spanitrm.exe&quot;), and from the real-time component interface.</p><div class=\"confluence-information-macro confluence-information-macro-information\"><p class=\"title\">Note</p><span class=\"aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon\"></span><div class=\"confluence-information-macro-body\"><p>SPAN Risk Manager functionality is a superset of that provided in PC-SPAN, so that any function available in PC-SPAN is also available in SPAN Risk Manager.</p></div></div><p><style type='text/css'>/*<![CDATA[*/\ndiv.rbtoc1741792366500 {padding: 0px;}\ndiv.rbtoc1741792366500 ul {list-style: disc;margin-left: 0px;}\ndiv.rbtoc1741792366500 li {margin-left: 0px;padding-left: 0px;}\n\n/*]]>*/</style><div class='toc-macro rbtoc1741792366500'>\n<ul class='toc-indentation'>\n<li><a href='#SPANRiskManagerFunctions-ProcessingFunctions'>Processing Functions</a>\n<ul class='toc-indentation'>\n\n<ul class='toc-indentation'>\n<li><a href='#SPANRiskManagerFunctions-CalculateOptionImpliedVolatilities'>Calculate Option Implied Volatilities</a></li>\n<li><a href='#SPANRiskManagerFunctions-AverageCall/PutVolatilities'>Average Call / Put Volatilities</a></li>\n<li><a href='#SPANRiskManagerFunctions-CalculateSeriesVolatilities'>Calculate Series Volatilities</a></li>\n<li><a href='#SPANRiskManagerFunctions-CalculateOptionPrices(andGreeks)'>Calculate Option Prices (and Greeks)</a></li>\n<li><a href='#SPANRiskManagerFunctions-CalculateRiskArrays'>Calculate Risk Arrays</a></li>\n<li><a href='#SPANRiskManagerFunctions-ReplicatePriceBasis'>Replicate Price Basis</a></li>\n<li><a href='#SPANRiskManagerFunctions-ApplyVolatilitySkew'>Apply Volatility Skew</a></li>\n<li><a href='#SPANRiskManagerFunctions-ObserveMarket'>Observe Market</a></li>\n<li><a href='#SPANRiskManagerFunctions-ResetPrices'>Reset Prices</a></li>\n</ul>\n<li><a href='#SPANRiskManagerFunctions-What-IfScenarioProcessing'>What-If Scenario Processing</a>\n<ul class='toc-indentation'>\n<li><a href='#SPANRiskManagerFunctions-DefineWhat-IfScenario'>Define What-If Scenario</a></li>\n<li><a href='#SPANRiskManagerFunctions-CompareScenarios'>Compare Scenarios</a></li>\n</ul>\n</li>\n<li><a href='#SPANRiskManagerFunctions-TypicalUsesofSPANRiskManager'>Typical Uses of SPAN Risk Manager</a>\n<ul class='toc-indentation'>\n<li><a href='#SPANRiskManagerFunctions-CalculationofSPANRiskArrays,CreationofSPANRiskParameterFiles'>Calculation of SPAN Risk Arrays, Creation of SPAN Risk Parameter Files</a></li>\n<li><a href='#SPANRiskManagerFunctions-StressTesting'>Stress Testing</a></li>\n<li><a href='#SPANRiskManagerFunctions-Real-TimePre-orPost-ExecutionRisk-BasedCreditControls'>Real-Time Pre- or Post-Execution Risk-Based Credit Controls</a></li>\n</ul>\n</li>\n<li><a href='#SPANRiskManagerFunctions-TradePosting'>Trade Posting</a>\n<ul class='toc-indentation'>\n<li><a href='#SPANRiskManagerFunctions-UpdatePositionsOnly'>Update Positions Only</a></li>\n<li><a href='#SPANRiskManagerFunctions-Trade-registermode'>Trade-register mode</a></li>\n<li><a href='#SPANRiskManagerFunctions-Bookkeepingmode'>Bookkeeping mode</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div></p><h1 id=\"SPANRiskManagerFunctions-ProcessingFunctions\"><strong>Processing Functions</strong></h1><h3 id=\"SPANRiskManagerFunctions-CalculateOptionImpliedVolatilities\"><strong>Calculate Option Implied Volatilities</strong></h3><p>This function may be performed for an entire point in time, or for any of several different levels defined within a point in time:\u00a0\u00a0an exchange complex, a combined commodity, an option product family, an option series, or a specific option.</p><p>For each option, an attempt is made to calculate the implied volatility.\u00a0\u00a0If successful, the volatility for the option is set to the new value.</p><h3 id=\"SPANRiskManagerFunctions-AverageCall/PutVolatilities\"><strong>Average Call / Put Volatilities</strong></h3><p>This function likewise may be performed for an entire point in time, or for any of several different levels defined within a point in time:\u00a0\u00a0an exchange complex, a combined commodity, an option product family, an option series, or a specific option.</p><p>The function searches for call / put pairs --\u00a0<em>ie,\u00a0</em>options which are identical except that one is a call and the other is a put.\u00a0\u00a0For each such pair:</p><ul><li><p>\u00a0If the volatility is defined for both the call and the put, then the average of these two values is taken, and both the call volatility and the put volatility are re-assigned as that average.<br/><br/></p></li><li><p>\u00a0If the volatility is defined for the call but not for the put, then the put volatility is assigned the value of the call volatility.<br/><br/></p></li><li><p>\u00a0If the volatility is defined for the put but not for the call, then the call volatility is assigned the value of the put volatility.</p></li></ul><p>\u00a0This function may be used if it is desired to ensure that corresponding calls and puts have the same value assigned for their volatility.</p><h3 id=\"SPANRiskManagerFunctions-CalculateSeriesVolatilities\"><strong>Calculate Series Volatilities</strong></h3><p>This function may be performed for an entire point in time, or for an exchange complex or specific combined commodity within a point in time.\u00a0\u00a0The lowest level to which this function is applicable is the combined commodity.\u00a0 (In other words, you can't calculate a series-average volatility just for one particular series, but have to at least do it for all series within a combined commodity.)</p><p>The function assigns a value to the volatility for the entire option series, for each option series to which it is applicable, and it guarantees that such &quot;series-average&quot; volatilities will be assigned.\u00a0\u00a0The algorithm calculates implied volatilities for around-the-money options and then assigns the series volatility as the average of those strike-level volatilities for the around-the-money options.\u00a0</p><h3 id=\"SPANRiskManagerFunctions-CalculateOptionPrices(andGreeks)\"><strong>Calculate Option Prices (and Greeks)</strong></h3><p>This function may be performed for an entire point in time, or for any of several different levels defined within a point in time:\u00a0\u00a0an exchange complex, a combined commodity, an option product family, an option series, or a specific option.</p><p>For selected options, the function calculates either:</p><ul><li>option price and delta, or<br/><br/></li><li>option price, delta, vega, gamma, theta, rho</li></ul><p>\u00a0In doing so, you can choose which volatilities to use, either:</p><ul><li>option strike-level volatilities only, or<br/><br/></li><li>option series-level volatilities only, or<br/><br/></li><li>option strike-level volatilities if they are defined, or series-level volatilities if a strike-level volatility is not defined.</li></ul><p>This last alternative is useful if it is desired to use strike-level volatilities, but if it is also possible, given the input data, that strikes may exist for which volatilities are not defined or cannot be calculated.\u00a0\u00a0In this case, since the algorithm for determining a series-average volatility guarantees that one will be assigned, using strike-level volatilities if they are available and series-level volatilities if not, guarantees that option prices are calculable for all options.</p><p>When calculating option prices, you can also choose to do this with &quot;with reset&quot; or &quot;without reset&quot;.\u00a0\u00a0If you are doing this &quot;with reset&quot;, then any previously defined option prices will be overwritten by the newly calculated prices.\u00a0\u00a0If you are calculating &quot;without reset&quot;, then option prices (and greeks) will not be calculated for any option for which a price is already defined.</p><p>The &quot;without reset&quot; capability is useful is you have valid market prices for some options and want to calculate theoretical prices only for the options for which market prices are not available.</p><h3 id=\"SPANRiskManagerFunctions-CalculateRiskArrays\"><strong>Calculate Risk Arrays</strong></h3><p>This function may be performed for an entire point in time, or for any of several different levels defined within a point in time:\u00a0\u00a0an exchange complex, a combined commodity, a product family, an option series, or a specific contract.</p><p>For selected contract(s) this function calculates SPAN risk arrays for each SPAN rate for which price scan range and volatility scan range are defined.</p><p>\u00a0In doing so, you can choose which volatilities to use (affects only option risk arrays), either:</p><ul><li>option strike-level volatilities only, or<br/><br/></li><li>option series-level volatilities only, or<br/><br/></li><li>option strike-level volatilities if they are defined, or series-level volatilities if a strike-level volatility is not defined.</li></ul><p>As with the calculation of option prices, this last alternative is useful if it is desired to use strike-level volatilities, but if it is also possible, given the input data, that strikes may exist for which volatilities are not defined or cannot be calculated.\u00a0\u00a0In this case, since the algorithm for determining a series-average volatility guarantees that one will be assigned, using strike-level volatilities if they are available and series-level volatilities if not, guarantees that risk arrays are calculable for all options.</p><h3 id=\"SPANRiskManagerFunctions-ReplicatePriceBasis\"><strong>Replicate Price Basis</strong></h3><p>This function may be performed for an entire point in time, an exchange complex, an exchange, a combined commodity, or a particular non-option product family.</p><p>For futures product families (and any other non-option product type) defined at a point in time where prices are available for some contracts but not for others, this function assigns theoretical prices to those other contracts.\u00a0 It does so by replicating the basis differentials for this product family for the immediately prior point in time.</p><p>For example, suppose at the previous point in time the price of the lead future was X and the price of the second future was Y.\u00a0 Suppose further that for the current point in time the price of the lead future was assigned as A and the price of the second future has not been defined.\u00a0 This function would assign the price of the second future as A + (Y-X).</p><h3 id=\"SPANRiskManagerFunctions-ApplyVolatilitySkew\"><strong>Apply Volatility Skew</strong></h3><p>This function may be performed for an entire point in time, an exchange complex, an exchange, a combined commodity, or a particular option product family.</p><p>For each option series defined at a point in time where volatilities are available for some options but not others, this function assigns volatilities to those other options in the series.\u00a0 It does so by replicating the volatility skew relationship from the same series at the immediately prior point in time.\u00a0\u00a0</p><p>In doing this, it applies both a\u00a0<strong>horizontal shift</strong>\u00a0and a\u00a0<strong>vertical shift</strong>:\u00a0 The best way to understand this is to think of a graph of strike price (on the X-axis) and volatility (on the Y-axis):</p><ul><li><p>The\u00a0<strong>horizontal shift</strong>\u00a0moves the volatility curve left or right according to how the underlying price has changed from the previous point in time to the current point in time -- ie, the price at which the at-the-money strike is defined.\u00a0 If the underlying price increases, for example, the curve is shifted to the right.<br/><br/></p></li><li><p>The\u00a0<strong>vertical shift</strong>\u00a0moves the volatility curve up or down according to how implied volatilities for the &quot;reference option(s)&quot; -- the option(s) that are closest to the money -- at the new point in time have changed from the analogous volatilities at the previous point in time.\u00a0\u00a0</p></li></ul><p>There are three different alternatives for applying the vertical shift:</p><ul><li><p><strong>Use separate call and put reference volatilities:</strong>\u00a0 select the closest-to-the-money call at the new point in time which has a volatility defined for it.\u00a0 If an exact at-the-money option exists and has a volatility defined, this is the selected one.\u00a0 If not, then select the call which is closest-to-the-money.\u00a0 (If an out-of-the-money call and an in-the-money call are equidistant-from-the-money, then select the out-of-the-money one.)\u00a0 Use this volatility as the reference for assigning volatilities to all other calls for which volatilities are not already defined.<br/><br/>Separately, repeat this logic to select the closest-to-the-money put at the new point which has a volatility defined for it, and use this volatility as the reference for assigning volatilities to all other puts for which volatilities are not already defined.<br/><br/></p></li><li><p><strong>Use best reference volatility:</strong>\u00a0\u00a0 Use the logic described above to select the closest-to-the-money call for which a volatility is defined, and the closest-to-the-money put for which a volatility is defined.\u00a0 If these two strikes are equidistant-from-the-money, take the average of their volatilities as the reference volatility.\u00a0 Otherwise, select the strike which is closest to the money, and use its volatility as the reference volatility.<br/><br/>This single value for best reference volatility is then used to assign volatilities to all options, calls and puts, at the new point in time for which volatilities are not already assigned.<br/><br/></p></li><li><p><strong>No reference:</strong>\u00a0 the volatility curve is shifted horizontally but not vertically.</p></li></ul><h3 id=\"SPANRiskManagerFunctions-ObserveMarket\"><strong>Observe Market</strong></h3><p>This function may be performed for an entire point in time, an exchange complex, an exchange, a combined commodity, or a particular product family.</p><p>For all contracts for which the function is performed, it does the following:</p><ul><li><p>Calculates the mark-to-market on the net position quantity from the previous value for contract price to the current value for contract price.<br/><br/></p></li><li><p>Takes the sum of three values:\u00a0 (a) the mark-to-market amount just calculated, (b) the previous value for mark-to-market on the position stored with the position, and (c) the value for mark-to-market on trades posted since the last market observation.<br/><br/></p></li><li><p>Stores this sum as the new value for mark-to-market on the position.<br/><br/></p></li><li><p>Resets the value for mark-to-market on trades posted since the last market observation to zero.<br/><br/></p></li><li><p>Stores the current value for contract price as the previous value for contract price.</p></li></ul><p>It calculates Mark to Market amounts for all portfolios defined for the point in time. Portfolios are marked to the latest prices set for the point in time.</p><h3 id=\"SPANRiskManagerFunctions-ResetPrices\"><strong>Reset Prices</strong></h3><p>This function may be performed for an entire point in time, an exchange complex, an exchange, a combined commodity, or a particular product family.</p><p>For all contracts for which the function is performed, it takes the current price and stores it as the &quot;previous&quot; price for the contract.\u00a0 In effect, it establishes the current price as the baseline for subsequent mark-to-market processing -- either trade posting or market observations.</p><h2 id=\"SPANRiskManagerFunctions-What-IfScenarioProcessing\"><strong>What-If Scenario Processing</strong></h2><p>The SPAN Risk Manager provides a rich set of capabilities for evaluating the impact of what-if scenarios, a function also known as\u00a0<strong>stress testing</strong>.\u00a0 This works as follows:</p><ul><li><p>A point in time is selected -- the\u00a0<strong>base</strong>\u00a0point in time.<br/><br/></p></li><li><p>A new point in time is created -- the\u00a0<strong>what-if\u00a0</strong>point in time -- by cloning the base point in time, and then applying a defined\u00a0<strong>what-if scenario</strong>\u00a0to it.\u00a0 The what-if scenario allows any or all of the following to be varied:\u00a0 price, volatility, price scan range, volatility scan range, time to expiration, risk-free interest rate, and dividend yield.<br/><br/></p></li><li><p>After the application of the what-if scenario to the what-if point in time, theoretical prices and SPAN risk arrays are calculated for it.<br/><br/></p></li><li><p>Performance bond requirements and portfolio values are then calculated for all portfolios for both the base point in time and the what-if point in time.<br/><br/></p></li><li><p>For each portfolio, the\u00a0<strong>impact\u00a0</strong>of applying the what-if scenario is then calculated as:<br/><br/></p><ul><li><p>the amount by which the portfolio value has increased, plus</p></li><li><p>the amount by which the SPAN risk has decreased.</p></li></ul></li></ul><p>Thus, a\u00a0<strong>positive impact</strong>\u00a0means that the portfolio gained in value and/or had its risk decrease.\u00a0 Conversely, a\u00a0<strong>negative impact</strong>\u00a0means that the portfolio lost value and/or had its risk increase.</p><h3 id=\"SPANRiskManagerFunctions-DefineWhat-IfScenario\"><strong>Define What-If Scenario</strong></h3><p>This function is always performed for an entire point in time.\u00a0 It is used to create a new point in time, identical to the original (&quot;base&quot;) one except that:</p><ul><li><p>it has a descriptor to identify it and distinguish it from the original point in time -- for example, &quot;S&amp;P's up 20%&quot;<br/><br/></p></li><li><p>any of the following parameters have been changed:\u00a0 price, volatility, price scan range, volatility scan range, time to expiration, risk-free interest rate, and/or dividend yield.</p></li></ul><p>The specification for how these parameters should be changed, and to which contracts the changes should be applied, constitute a\u00a0<strong>what-if scenario</strong>.</p><p>You start by pointing to the original, base point in time, right-mouse click, and select\u00a0<strong>What-If Scenario.</strong></p><p>The\u00a0<strong>Create What-If Scenario</strong>\u00a0dialog box displays, prompting you to enter a descriptor for the what-if scenario.\u00a0 You enter the descriptor and click on\u00a0<strong>Create New</strong>.</p><p>The full\u00a0<strong>Define What-If Scenario</strong>\u00a0dialog box now displays.\u00a0 This allows the specification of the changes to be applied to the above parameters:</p><ul><li><p>You specify which parameter is to be changed -- price, volatility, price scan range, volatility scan range, time to expiration, risk-free interest rate, and/or dividend yield.<br/><br/></p></li><li><p>For each such parameter, you specify how it is to be changed by selecting one of the three options, and then specify the value:<br/><br/></p><ul><li><p><strong>Set</strong>\u00a0-- sets the parameter to the specified value;</p></li><li><p><strong>Change</strong>\u00a0-- changes the parameter by the specified amount.\u00a0 (A negative amount decreases the parameter.)</p></li><li><p><strong>Change Percent</strong>\u00a0-- changes the parameter by the specified percentage.\u00a0 (A negative value decreases the parameter by the specified percentage.)<br/><br/></p></li></ul></li><li><p>By expanding or contracting nodes on the tree in the dialog box, you can specify the data elements to which you want the changes to be applied:<br/><br/></p><ul><li><p>to the entire newly-created point in time<br/><br/></p></li><li><p>to an exchange complex within that point in time<br/><br/></p></li><li><p>to a combined commodity within that exchange complex, or<br/><br/></p></li><li><p>to a particular product family linked into that combined commodity.</p></li></ul></li></ul><p>After the desired what-if parameters have been defined, you can click on either\u00a0<strong>OK</strong>\u00a0or\u00a0<strong>Calculate</strong>:</p><ul><li><p><strong>OK</strong>\u00a0causes the new point in time to be created and the what-if scenarios applied to it.<br/><br/></p></li><li><p><strong>Calculate</strong>\u00a0does the following:<br/><br/></p><ul><li><p>Creates the new point in time and applies the what-if scenarios to it.<br/><br/></p></li><li><p>Calculates option theoretical prices and SPAN risk arrays for the new point in time.\u00a0 Strike-level volatilities are used if they exist and series-level volatilities if not.\u00a0 Option prices are calculated &quot;with reset&quot; --\u00a0<em>ie,\u00a0</em>prices are calculated for all options regardless of whether prices are already defined for them.<br/><br/></p></li><li><p>Calculates performance bond requirements for all portfolios at both the original (&quot;base&quot;) point in time and the newly-created point in time.<br/><br/></p></li><li><p>Displays the\u00a0<strong>Compare Scenarios</strong>\u00a0dialog box, displaying the impact of the what-if scenario on the portfolios.</p></li></ul></li></ul><p>Note that you can also choose to define and apply Risk Scenarios to an existing point in time rather than creating a new one:</p><ul><li><p>Point to the desired point-in-time.\u00a0 Right-mouse click on it, select\u00a0<strong>What-If Scenario</strong>, then click on\u00a0<strong>Modify</strong>.</p></li></ul><h3 id=\"SPANRiskManagerFunctions-CompareScenarios\"><strong>Compare Scenarios</strong></h3><p>This function is likewise always performed for a particular point in time.\u00a0 It allows the comparison of the impacts associated with any particular what-if scenario.\u00a0 To use it:</p><ul><li><p>Point to the what-if point in time.<br/><br/></p></li><li><p>Right-mouse click, then select\u00a0<strong>Compare Scenarios</strong>.<br/><br/></p></li><li><p>The\u00a0<strong>Select Point in Time</strong>\u00a0dialog box pops up.\u00a0 Select the &quot;base&quot; point in time, then click on\u00a0<strong>OK</strong>.<br/><br/></p></li><li><p>The\u00a0<strong>Compare Scenarios</strong>\u00a0dialog box displays.</p><hr/></li></ul><h2 id=\"SPANRiskManagerFunctions-TypicalUsesofSPANRiskManager\"><strong>Typical Uses of SPAN Risk Manager</strong></h2><h3 id=\"SPANRiskManagerFunctions-CalculationofSPANRiskArrays,CreationofSPANRiskParameterFiles\"><strong>Calculation of SPAN Risk Arrays, Creation of SPAN Risk Parameter Files</strong></h3><p>An exchange or a clearing organization implementing SPAN needs a way to calculate SPAN risk arrays for all of its products and publish at least one daily SPAN risk parameter file.\u00a0 A typical set of operations would be:</p><ul><li><p>Via\u00a0<strong>spanitrm</strong>\u00a0and a script file:</p><ul><li><p>Load the &quot;null&quot; risk parameter file, in which SPAN risk arrays and composite delta values are all zero (because they have not yet been calculated.)<br/><br/></p></li><li><p>Calculate series-average volatilities for all option series.<br/><br/></p></li><li><p>Calculate individual strike-level implied volatilities for all options.<br/><br/></p></li><li><p>Average corresponding call and put volatilities.<br/><br/></p></li><li><p>Calculate risk arrays for all contracts using strike-level volatilities if they are defined and series-level volatilities if not.<br/><br/></p></li><li><p>Save the SPAN document, thereby creating the XML-based SPAN risk parameter file.</p></li></ul></li><li><p>If desired, use the\u00a0<strong>x2p</strong>\u00a0conversion utility to create the SPAN risk parameter file in the expanded-unpacked or standard-unpacked format.</p></li></ul><h3 id=\"SPANRiskManagerFunctions-StressTesting\"><strong>Stress Testing</strong></h3><p>Evaluating the impact on a set of portfolios of various hypothetical market occurrences over the next trading day is always an important requirement.\u00a0\u00a0 Such &quot;stress testing&quot; allows the impact of common hypothetical market occurrences to be determined in advance and thereby allows rapid response in the event any such scenario occurs.</p><p>To do this in an automated way:</p><ul><li><p>Via\u00a0<strong>spanitrm</strong>\u00a0and a script file:<br/><br/></p><ul><li><p>Create and save the &quot;base&quot; SPAN risk parameter file.<br/><br/></p></li><li><p>Load portfolios, calculate margins and portfolio values, save the results to a &quot;base case&quot; SPAN document file.<br/><br/></p></li><li><p>For each &quot;scenario set&quot; for which it is desired to perform stress testing:<br/><br/></p><ul><li><p>From the base point in time, create a new point-in-time with a descriptor identifying the scenario set.<br/><br/></p></li><li><p>Apply the changes to prices, volatilities, price and volatility scan ranges, interest rates, and time to expiration associated with the scenario set.<br/><br/></p></li><li><p>Apply the volatility skew with &quot;no reference&quot; to shift the volatilities horizontally for each option series according to the move in the underlying price.<br/><br/></p></li><li><p>Recalculate theoretical prices for all options.<br/><br/></p></li><li><p>Recalculate risk arrays for all contracts.<br/><br/></p></li><li><p>Recalculate margin requirements and portfolio values for all portfolios.<br/><br/></p></li></ul></li><li><p>Save the results to an overall SPAN document file.<br/><br/></p></li></ul></li><li><p>Open the resulting document file in SPAN Risk Manager and view impacts.\u00a0</p></li></ul><h3 id=\"SPANRiskManagerFunctions-Real-TimePre-orPost-ExecutionRisk-BasedCreditControls\"><strong>Real-Time Pre- or Post-Execution Risk-Based Credit Controls</strong></h3><p>If an order to execute a trade has been placed, it is often desirable to evaluate, in real-time, the impact of such a trade on the portfolio risk, margin requirement, and value.\u00a0 Based upon this impact, again in real time, the order may be accepted or rejected.\u00a0 Even if such &quot;pre-execution&quot; credit controls are not implemented, it many cases it will be extremely valuable to implement such real-time checking post-execution.\u00a0 One of SPAN Risk Manager's most important capabilities is the ability to implement this.</p><p>Typically this would be implemented via a multi-platform strategy -- one platform in order to update the risk profile of the various products in a &quot;continuous batch&quot; process, and another platform or set of platforms in order to apply the results to portfolios in real time as orders are provided and/or trades are executed.</p><p>On one platform for the updating the risk profile:</p><ul><li><p>Via either\u00a0<strong>spanitrm</strong>\u00a0or the real-time component interface for the SPAN Risk Manager:<br/><br/></p><ul><li><p>Load the SPAN risk parameter file for the immediately previous point in time.<br/><br/></p></li><li><p>Clone the data for the previous point in time to a new point in time.<br/><br/></p></li><li><p>Update market prices for the most actively trading futures, physicals and options.<br/><br/></p></li><li><p>Execute the &quot;Replicate Price Basis&quot; function in order to assign theoretical prices to futures for which current market prices were not available.<br/><br/></p></li><li><p>Calculate implied volatilities for the actively trading options for which market prices were available.<br/><br/></p></li><li><p>Execute the &quot;Apply Volatility Skew&quot; function in order to assign volatilities for all other options, taking into account both the implied volatilities for the options with current market prices, and the volatility skew from the previous point in time.<br/><br/></p></li><li><p>Calculate theoretical prices for all options except the ones for which current market prices were available.<br/><br/></p></li><li><p>Recalculate risk arrays for all instruments.<br/><br/></p></li><li><p>Clear the data for the previous point in time from memory.<br/><br/></p></li><li><p>Save the results to a SPAN document file for the new point in time.</p></li></ul></li></ul><p>Total time required to execute such a cycle will depend on the number of instruments, the pricing models used, and the overall speed and memory capacity of the execution platform.\u00a0 In many or most cases, however, total execution time will be measured in seconds.\u00a0 In other words, execution time is not the limiting factor and this part of the process can be executed as often as desired during the trading day.\u00a0 As often as every minute or two, or as infrequently as several times per day, the process can be executed in order to obtain an updated SPAN document file reflecting current market conditions.\u00a0 The more volatile the market, and the more it is desired to have the process reflect current market conditions, the more important it is to increase the frequency of such updates.</p><p>The process of applying the orders or trades to the SPAN document reflecting updated market conditions would typically be executed in real-time, via the real-time component interface, on one or more separate execution platforms:</p><ul><li><p>Via the real-time component interface:<br/><br/></p><ul><li><p>Open the SPAN document file for the latest point in time.<br/><br/></p></li><li><p>Load portfolios current up to the latest point in time.<br/><br/></p></li><li><p>As orders are placed and/or trades are executed:<br/><br/></p><ul><li><p>Post the trade, thereby updating the position quantities.<br/><br/></p></li><li><p>Calculate margin requirement and portfolio value.<br/><br/></p></li><li><p>Get the updated margin requirement and portfolio value.\u00a0 Take appropriate action based upon how the trade or order has caused the risk or the portfolio value to change.<br/><br/></p></li></ul></li><li><p>When a new SPAN document file is available reflecting updated market conditions, pause the real-time trade poster, and re-initiate the process with that new SPAN document file.</p></li></ul></li></ul><h2 id=\"SPANRiskManagerFunctions-TradePosting\"><strong>Trade Posting</strong></h2><p>The SPAN Risk Manager software will very shortly add full &quot;trade posting&quot; capability, providing new position management and bookkeeping functions.</p><p>Trades may be posted by loading a file of trades, from the GUI, the batch interface, or the real-time component interface.\u00a0 Alternatively, trades may be posted one-by-one through the component interface.</p><p>Trade posting may be performed in any of three modes:</p><ul><li><p><strong>Update positions only<br/><br/></strong></p></li><li><p><strong>Trade-register mode<br/><br/></strong></p></li><li><p><strong>Bookkeeping mode</strong></p></li></ul><h3 id=\"SPANRiskManagerFunctions-UpdatePositionsOnly\"><strong>Update Positions Only</strong></h3><p>When trade posting is performed in this mode, as each trade is posted, the following is done:</p><ul><li><p>The position quantity is updated<br/><br/></p></li><li><p>The mark-to-market on the trade is calculated from trade price to current market price, and:<br/><br/></p><ul><li><p>For the position, the mark-to-market amount on trades posted since the last market observation is incremented by this result.<br/><br/></p></li><li><p>For the product family, the overall amount for mark-to-market amount on trades posted since the last observation is similarly incremented by this result.<br/><br/></p></li><li><p>At higher levels (the combined commodity, exchange complex, and portfolio as a whole), the mark-to-market amount on trades posted since the last observation is similarly incremented, with the caveat that separate buckets are maintained for mark-to-market on trades for futures-style products, and for non-futures-style products.<br/><br/></p></li></ul></li><li><p>If the product is a premium-style product (for example, a premium-style option, or an equity or debt security), the option premium (ie, price obligation) is calculated for the trade, and:<br/><br/></p><ul><li><p>For the position, the option premium (accumulated price obligation) field is incremented for this result.<br/><br/></p></li><li><p>For the product family, the option premium (accumulated price obligation) field is similarly incremented for this result.<br/><br/></p></li><li><p>At higher levels (the combined commodity, exchange complex, and portfolio as a whole), the accumulated premium (price obligation) is similarly incremented, with the caveat that separate buckets are maintained for accumulated premium on premium-style options, and accumulated price obligation for non-options such as equity and debt securities and other physicals.</p></li></ul></li></ul><p>In other words, aggregate mark-to-market amounts are broken out into separate fields for true settlement variation which will be banked for futures-style products, and mark-to-market amount which is provided for information for non-futures-style products.\u00a0 Premium (price obligation) is calculated for any product which is not valued futures-style, and is aggregated separately for premium-style options and other premium (equity) style products.</p><p>Typical usage for real-time risk intraday real-time risk management would be as follows:</p><ul><li><p>Load the end-of-day SPAN file for the previous business day.<br/><br/></p></li><li><p>Load the beginning of day positions.<br/><br/></p></li><li><p>As trades occur, in real time, post them, causing the positions, the mark-to-market amount on trades, and the accumulated premium (price obligation) to be updated.<br/><br/></p></li><li><p>As often as desired, bring in an updated set of market prices, and perform a market observation.\u00a0 This causes the positions to be marked-to-market from previous market price to current market price, increments the updated mark-to-market amount on the position by the amount on trades posted since the last market observation, and then sets the mark-to-market amounts on such trades to zero.<br/><br/></p></li><li><p>Monitor the accumulated mark-to-market and price obligation fields in real-time, taking action as needed.</p></li></ul><h3 id=\"SPANRiskManagerFunctions-Trade-registermode\"><strong>Trade-register mode</strong></h3><p>In addition to the functions performed in &quot;Update positions only&quot; mode, Trade Register mode saves, for each posted trade, the mark-to-market amount and, if it is for a premium-style product, the price obligation.\u00a0 This data is saved to a separate Trade Register file, from which various Trade Register reports and datafiles can be prepared.</p><p>Typical end-of-day usage would be as follows:</p><ul><li><p>Produce the end-of-day SPAN risk parameter file.<br/><br/></p></li><li><p>Produce a trade file consisting of:<br/><br/></p><ul><li><p>beginning of day positions, with trade price specified as end-of-day settlement prices for the previous day, for futures-style products, and as zero for premium-style products<br/><br/></p></li><li><p>all trades for the day just ended.<br/><br/></p></li></ul></li><li><p>Post the trades from that trade file, specifying that a Trade Register file be created.<br/><br/></p></li><li><p>From the resulting Trade Register file, produce reports showing:<br/><br/></p><ul><li><p>for futures-style positions:<br/><br/></p><ul><li><p>the beginning of day position and its mark-to-market from previous-day's settlement price to current day's settlement price<br/><br/></p></li><li><p>for each trade, the mark-to-market from trade price to current day's settlement price.<br/><br/></p></li></ul></li><li><p>for premium-style positions:<br/><br/></p><ul><li><p>the beginning of day position<br/><br/></p></li><li><p>for each trade, the premium (price) obligation.</p></li></ul></li></ul></li></ul><h3 id=\"SPANRiskManagerFunctions-Bookkeepingmode\"><strong>Bookkeeping mode</strong></h3><p>In addition to the functions performed in &quot;Update positions only&quot; mode, Bookkeeping mode tracks individual Open Trades behind each net position and does FIFO position offsetting and profit &amp; loss accounting.\u00a0 The result are datafiles from which basic bookkeeping reports can be produced.</p><p>The SPAN document file itself in this case stores the individual Open Trades behind each net position.\u00a0 For each open trade, the following is stored:</p><ul><li><p>the original date on which the Open Trade was created</p></li><li><p>the original open quantity and original trade price</p></li><li><p>the currently open quantity, ie, the remaining open quantity</p></li><li><p>the unrealized P&amp;L --\u00a0<em>ie,\u00a0</em>the accumulated profit or loss on the remaining open quantity</p></li><li><p>the realized P&amp;L --\u00a0<em>ie,\u00a0</em>the accumulated profit or loss on the closed quantity.</p></li></ul><p>When the open trade has been fully liquidated, the currently open quantity will be zero as will the unrealized P&amp;L.\u00a0 All P&amp;L will have been realized.</p><p>At any instant in time, then, there will be one or more open trades behind each net position.\u00a0 The open quantities on each open trade with nonzero value for currently open quantity, must of necessity be of the same sign as that of the current value for net position.</p><p>For example, suppose on day one you start out flat in a particular instrument and post two buy trades for quantities of 10 at different prices.\u00a0 The result is a net position of +20, with two open trades behind that position, each for an original quantity and a currently open quantity of +10.</p><p>Suppose on the next day you clear a sell trade for a quantity of -30.\u00a0 The first -10 will offset the first open trade, causing its open quantity to be set to zero and all P&amp;L on the open trade to be realized.\u00a0 In effect, it is a &quot;closed trade&quot;.\u00a0 The second -10 will similarly offset the second open trade.\u00a0 The last -10 will establish a new open trade, at its trade price, with an open quantity of -10, and the mark-to-market from trade price to end of day market price stored as unrealized P&amp;L.\u00a0 The overall net position will be -10.</p><p>In addition to the updating of the net positions and of the open trade(s) behind the net positions, bookkeeping mode causes a Bookkeeping Register datafile to be produced.\u00a0 This lists, for each trade posted, what occurred:</p><ul><li><p>If the trade quantity is on the same side of the market as the current net position, then the trade establishes a new Open Trade behind the position.<br/><br/></p></li><li><p>If the trade quantity is on the opposite side of the market as the current net position, then:<br/><br/></p><ul><li><p>the trade posting will cause one or more Open Trades to be partially or completely liquidated, bringing the currently open quantity back towards zero and causing unrealized P&amp;L to be updated and transferred to realized P&amp;L.<br/><br/></p></li><li><p>if the absolute value of the trade quantity was greater than the absolute value of the net position, then all previously open Open Trades will be complete liquidated, and a new Open Trade will be established on the opposite side of the market for the excess.</p></li></ul></li></ul><p>From the SPAN document file and the Bookkeeping Register datafile, bookkeeping reports can be produced.</p>"
        }
    },
    "status": "current",
    "title": "SPAN Risk Manager Functions",
    "spaceId": "457312811",
    "id": "457411209",
    "_links": {
        "editui": "/pages/resumedraft.action?draftId=457411209",
        "webui": "/spaces/pubsub/pages/457411209/SPAN+Risk+Manager+Functions",
        "edituiv2": "/spaces/pubsub/pages/edit-v2/457411209",
        "tinyui": "/x/iYpDGw",
        "base": "https://cmegroupclientsite.atlassian.net/wiki"
    }
}